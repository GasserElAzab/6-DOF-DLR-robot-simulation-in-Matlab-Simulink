q1= sym('q1');
q2= sym('q2');
q3= sym('q3');
q4= sym('q4');
q5= sym('q5');
q6= sym('q6');
L1= sym('L1');
L2= sym('L2');
L3= sym('L3');
L4= sym('L4');


A0T1= [ cos(0.0175*q1 - 1.5708),  0, -sin(0.0175*q1 - 1.5708),  0;...
 sin(0.0175*q1 - 1.5708),  0,  cos(0.0175*q1 - 1.5708),  0;...
                       0, -1,                        0, L1];
                   


A0T2= [ cos(0.0175*q1 - 1.5708)*cos(0.0175*q2 - 1.5708), -sin(0.0175*q1 - 1.5708), cos(0.0175*q1 - 1.5708)*sin(0.0175*q2 - 1.5708),  0;...
 cos(0.0175*q2 - 1.5708)*sin(0.0175*q1 - 1.5708),  cos(0.0175*q1 - 1.5708), sin(0.0175*q1 - 1.5708)*sin(0.0175*q2 - 1.5708),  0;...
                        -sin(0.0175*q2 - 1.5708),                        0,                         cos(0.0175*q2 - 1.5708), L1];
                                        
A0T3=  [ cos(0.0175*q1 - 1.5708)*cos(0.0175*q2 - 1.5708), -sin(0.0175*q1 - 1.5708), cos(0.0175*q1 - 1.5708)*sin(0.0175*q2 - 1.5708), cos(0.0175*q1 - 1.5708)*sin(0.0175*q2 - 1.5708)*(L2 + q3);...
 cos(0.0175*q2 - 1.5708)*sin(0.0175*q1 - 1.5708),  cos(0.0175*q1 - 1.5708), sin(0.0175*q1 - 1.5708)*sin(0.0175*q2 - 1.5708), sin(0.0175*q1 - 1.5708)*sin(0.0175*q2 - 1.5708)*(L2 + q3);...
                        -sin(0.0175*q2 - 1.5708),                        0,                         cos(0.0175*q2 - 1.5708),                    L1 + cos(0.0175*q2 - 1.5708)*(L2 + q3)];
                    
A0T4= [ cos(0.0175*q1 - 1.5708)*cos(0.0175*q2 - 1.5708)*cos(0.0175*q4 + 1.5708) - sin(0.0175*q1 - 1.5708)*sin(0.0175*q4 + 1.5708), cos(0.0175*q1 - 1.5708)*sin(0.0175*q2 - 1.5708), cos(0.0175*q4 + 1.5708)*sin(0.0175*q1 - 1.5708) + cos(0.0175*q1 - 1.5708)*cos(0.0175*q2 - 1.5708)*sin(0.0175*q4 + 1.5708), cos(0.0175*q1 - 1.5708)*sin(0.0175*q2 - 1.5708)*(L2 + q3) + L3*cos(0.0175*q1 - 1.5708)*sin(0.0175*q2 - 1.5708);...
 cos(0.0175*q1 - 1.5708)*sin(0.0175*q4 + 1.5708) + cos(0.0175*q2 - 1.5708)*cos(0.0175*q4 + 1.5708)*sin(0.0175*q1 - 1.5708), sin(0.0175*q1 - 1.5708)*sin(0.0175*q2 - 1.5708), cos(0.0175*q2 - 1.5708)*sin(0.0175*q1 - 1.5708)*sin(0.0175*q4 + 1.5708) - cos(0.0175*q1 - 1.5708)*cos(0.0175*q4 + 1.5708), sin(0.0175*q1 - 1.5708)*sin(0.0175*q2 - 1.5708)*(L2 + q3) + L3*sin(0.0175*q1 - 1.5708)*sin(0.0175*q2 - 1.5708);...
                                                                          -cos(0.0175*q4 + 1.5708)*sin(0.0175*q2 - 1.5708),                         cos(0.0175*q2 - 1.5708),                                                                          -sin(0.0175*q2 - 1.5708)*sin(0.0175*q4 + 1.5708),                                            L1 + cos(0.0175*q2 - 1.5708)*(L2 + q3) + L3*cos(0.0175*q2 - 1.5708)];
                                                                      
A0T5= [ cos(0.0175*q1 - 1.5708)*sin(0.0175*q2 - 1.5708)*sin(0.0175*q5 + 1.5708) - cos(0.0175*q5 + 1.5708)*(sin(0.0175*q1 - 1.5708)*sin(0.0175*q4 + 1.5708) - cos(0.0175*q1 - 1.5708)*cos(0.0175*q2 - 1.5708)*cos(0.0175*q4 + 1.5708)), cos(0.0175*q4 + 1.5708)*sin(0.0175*q1 - 1.5708) + cos(0.0175*q1 - 1.5708)*cos(0.0175*q2 - 1.5708)*sin(0.0175*q4 + 1.5708), - sin(0.0175*q5 + 1.5708)*(sin(0.0175*q1 - 1.5708)*sin(0.0175*q4 + 1.5708) - cos(0.0175*q1 - 1.5708)*cos(0.0175*q2 - 1.5708)*cos(0.0175*q4 + 1.5708)) - cos(0.0175*q1 - 1.5708)*cos(0.0175*q5 + 1.5708)*sin(0.0175*q2 - 1.5708), cos(0.0175*q1 - 1.5708)*sin(0.0175*q2 - 1.5708)*(L2 + q3) + L3*cos(0.0175*q1 - 1.5708)*sin(0.0175*q2 - 1.5708);...
 cos(0.0175*q5 + 1.5708)*(cos(0.0175*q1 - 1.5708)*sin(0.0175*q4 + 1.5708) + cos(0.0175*q2 - 1.5708)*cos(0.0175*q4 + 1.5708)*sin(0.0175*q1 - 1.5708)) + sin(0.0175*q1 - 1.5708)*sin(0.0175*q2 - 1.5708)*sin(0.0175*q5 + 1.5708), cos(0.0175*q2 - 1.5708)*sin(0.0175*q1 - 1.5708)*sin(0.0175*q4 + 1.5708) - cos(0.0175*q1 - 1.5708)*cos(0.0175*q4 + 1.5708),   sin(0.0175*q5 + 1.5708)*(cos(0.0175*q1 - 1.5708)*sin(0.0175*q4 + 1.5708) + cos(0.0175*q2 - 1.5708)*cos(0.0175*q4 + 1.5708)*sin(0.0175*q1 - 1.5708)) - cos(0.0175*q5 + 1.5708)*sin(0.0175*q1 - 1.5708)*sin(0.0175*q2 - 1.5708), sin(0.0175*q1 - 1.5708)*sin(0.0175*q2 - 1.5708)*(L2 + q3) + L3*sin(0.0175*q1 - 1.5708)*sin(0.0175*q2 - 1.5708);...
                                                                                                     cos(0.0175*q2 - 1.5708)*sin(0.0175*q5 + 1.5708) - cos(0.0175*q4 + 1.5708)*cos(0.0175*q5 + 1.5708)*sin(0.0175*q2 - 1.5708),                                                                          -sin(0.0175*q2 - 1.5708)*sin(0.0175*q4 + 1.5708),                                                                                                     - cos(0.0175*q2 - 1.5708)*cos(0.0175*q5 + 1.5708) - cos(0.0175*q4 + 1.5708)*sin(0.0175*q2 - 1.5708)*sin(0.0175*q5 + 1.5708),                                            L1 + cos(0.0175*q2 - 1.5708)*(L2 + q3) + L3*cos(0.0175*q2 - 1.5708)];
                                                                                                 
                                                                                                 
A0T6= [ sin((pi*q6)/180)*(cos((pi*(q4 + 90))/180)*sin((pi*(q1 - 90))/180) + cos((pi*(q1 - 90))/180)*cos((pi*(q2 - 90))/180)*sin((pi*(q4 + 90))/180)) - cos((pi*q6)/180)*(cos((pi*(q5 + 90))/180)*(sin((pi*(q1 - 90))/180)*sin((pi*(q4 + 90))/180) - cos((pi*(q1 - 90))/180)*cos((pi*(q2 - 90))/180)*cos((pi*(q4 + 90))/180)) - cos((pi*(q1 - 90))/180)*sin((pi*(q2 - 90))/180)*sin((pi*(q5 + 90))/180)),   sin((pi*q6)/180)*(cos((pi*(q5 + 90))/180)*(sin((pi*(q1 - 90))/180)*sin((pi*(q4 + 90))/180) - cos((pi*(q1 - 90))/180)*cos((pi*(q2 - 90))/180)*cos((pi*(q4 + 90))/180)) - cos((pi*(q1 - 90))/180)*sin((pi*(q2 - 90))/180)*sin((pi*(q5 + 90))/180)) + cos((pi*q6)/180)*(cos((pi*(q4 + 90))/180)*sin((pi*(q1 - 90))/180) + cos((pi*(q1 - 90))/180)*cos((pi*(q2 - 90))/180)*sin((pi*(q4 + 90))/180)), - sin((pi*(q5 + 90))/180)*(sin((pi*(q1 - 90))/180)*sin((pi*(q4 + 90))/180) - cos((pi*(q1 - 90))/180)*cos((pi*(q2 - 90))/180)*cos((pi*(q4 + 90))/180)) - cos((pi*(q1 - 90))/180)*cos((pi*(q5 + 90))/180)*sin((pi*(q2 - 90))/180), cos((pi*(q1 - 90))/180)*sin((pi*(q2 - 90))/180)*(L2 + q3) - L4*(sin((pi*(q5 + 90))/180)*(sin((pi*(q1 - 90))/180)*sin((pi*(q4 + 90))/180) - cos((pi*(q1 - 90))/180)*cos((pi*(q2 - 90))/180)*cos((pi*(q4 + 90))/180)) + cos((pi*(q1 - 90))/180)*cos((pi*(q5 + 90))/180)*sin((pi*(q2 - 90))/180)) + L3*cos((pi*(q1 - 90))/180)*sin((pi*(q2 - 90))/180);
 cos((pi*q6)/180)*(cos((pi*(q5 + 90))/180)*(cos((pi*(q1 - 90))/180)*sin((pi*(q4 + 90))/180) + cos((pi*(q2 - 90))/180)*cos((pi*(q4 + 90))/180)*sin((pi*(q1 - 90))/180)) + sin((pi*(q1 - 90))/180)*sin((pi*(q2 - 90))/180)*sin((pi*(q5 + 90))/180)) - sin((pi*q6)/180)*(cos((pi*(q1 - 90))/180)*cos((pi*(q4 + 90))/180) - cos((pi*(q2 - 90))/180)*sin((pi*(q1 - 90))/180)*sin((pi*(q4 + 90))/180)), - sin((pi*q6)/180)*(cos((pi*(q5 + 90))/180)*(cos((pi*(q1 - 90))/180)*sin((pi*(q4 + 90))/180) + cos((pi*(q2 - 90))/180)*cos((pi*(q4 + 90))/180)*sin((pi*(q1 - 90))/180)) + sin((pi*(q1 - 90))/180)*sin((pi*(q2 - 90))/180)*sin((pi*(q5 + 90))/180)) - cos((pi*q6)/180)*(cos((pi*(q1 - 90))/180)*cos((pi*(q4 + 90))/180) - cos((pi*(q2 - 90))/180)*sin((pi*(q1 - 90))/180)*sin((pi*(q4 + 90))/180)),   sin((pi*(q5 + 90))/180)*(cos((pi*(q1 - 90))/180)*sin((pi*(q4 + 90))/180) + cos((pi*(q2 - 90))/180)*cos((pi*(q4 + 90))/180)*sin((pi*(q1 - 90))/180)) - cos((pi*(q5 + 90))/180)*sin((pi*(q1 - 90))/180)*sin((pi*(q2 - 90))/180), L4*(sin((pi*(q5 + 90))/180)*(cos((pi*(q1 - 90))/180)*sin((pi*(q4 + 90))/180) + cos((pi*(q2 - 90))/180)*cos((pi*(q4 + 90))/180)*sin((pi*(q1 - 90))/180)) - cos((pi*(q5 + 90))/180)*sin((pi*(q1 - 90))/180)*sin((pi*(q2 - 90))/180)) + sin((pi*(q1 - 90))/180)*sin((pi*(q2 - 90))/180)*(L2 + q3) + L3*sin((pi*(q1 - 90))/180)*sin((pi*(q2 - 90))/180);
                                                                                                                                                                                 cos((pi*q6)/180)*(cos((pi*(q2 - 90))/180)*sin((pi*(q5 + 90))/180) - cos((pi*(q4 + 90))/180)*cos((pi*(q5 + 90))/180)*sin((pi*(q2 - 90))/180)) - sin((pi*q6)/180)*sin((pi*(q2 - 90))/180)*sin((pi*(q4 + 90))/180),                                                                                                                                                                                 - sin((pi*q6)/180)*(cos((pi*(q2 - 90))/180)*sin((pi*(q5 + 90))/180) - cos((pi*(q4 + 90))/180)*cos((pi*(q5 + 90))/180)*sin((pi*(q2 - 90))/180)) - cos((pi*q6)/180)*sin((pi*(q2 - 90))/180)*sin((pi*(q4 + 90))/180),                                                                                                     - cos((pi*(q2 - 90))/180)*cos((pi*(q5 + 90))/180) - cos((pi*(q4 + 90))/180)*sin((pi*(q2 - 90))/180)*sin((pi*(q5 + 90))/180),                                                                                                                                                L1 - L4*(cos((pi*(q2 - 90))/180)*cos((pi*(q5 + 90))/180) + cos((pi*(q4 + 90))/180)*sin((pi*(q2 - 90))/180)*sin((pi*(q5 + 90))/180)) + cos((pi*(q2 - 90))/180)*(L2 + q3) + L3*cos((pi*(q2 - 90))/180)];
                                                                                                                                                                                                                                  
                                                                                                                   
 
Jv1= cross([0;0;1], A0T6(:,4)-[0;0;0]); 
Jv2= cross(A0T1(:,3),(A0T6(:,4)-A0T1(:,4)));
Jv3= A0T3(:,3);
Jv4= cross(A0T3(:,3),(A0T6(:,4)-A0T3(:,4)));
Jv5= cross(A0T4(:,3),(A0T6(:,4)-A0T4(:,4)));
Jv6= cross(A0T5(:,3),(A0T6(:,4)-A0T5(:,4)));

Jw1=[0;0;1];
Jw2= A0T1(:,3);
Jw3=[0;0;0];
Jw4= A0T3(:,3);
Jw5= A0T4(:,3);
Jw6= A0T5(:,3);
VelocityMat= [Jv1 Jv2 Jv3 Jv4 Jv5 Jv6; Jw1 Jw2 Jw3 Jw4 Jw5 Jw6];
inverseVMAT= transpose(VelocityMat)*(inv(VelocityMat*transpose(VelocityMat)));